println "======================================== critical updates =========================="
subprojects {
    configurations.all {
        resolutionStrategy.eachDependency { DependencyResolveDetails details ->
            if (details.requested.group.contains('org.apache.bcel') && 
                    details.requested.name.contains('bcel') &&
                    details.requested.version.contains('6.5.0')) {
                    println "correction cve-org.apache.bcel.bcel-6.6.1"
                    details.useVersion '6.6.1'
            }
            if (details.requested.group.contains('org.apache.commons') && 
                    details.requested.name.contains('commons-text') &&
                    details.requested.version.contains('1.9')) {
                    println "correction cpe:2.3:a:apache:commons_text:1.9"
                    details.useVersion '1.10.0'
            }
            if (details.requested.group.contains('com.fasterxml.jackson.core') && 
                    details.requested.name.contains('jackson-core')) {
                    println "correction CVE-2022-45688 CWE-787 Out-of-bounds Write"
                    details.useVersion '2.18.2'
            }
            if (details.requested.group.contains('org.dom4j') && 
                    details.requested.name.contains('dom4j')) {
                    println "correction cpe:2.3:a:dom4j:2.1.3"
                    details.useVersion '2.1.4'
            }
            if (details.requested.group.contains('com.fasterxml.jackson.core') && 
                    details.requested.name.contains('jackson-core')) {
                    println "correction CVE-2022-45688 CWE-787 Out-of-bounds Write"
                    details.useVersion '2.18.2'
            }
        }
    }
}